clear classes

distReal = ...
    [...H    He    Li    Be     B     C     N     O     F    Ne    Na    Mg    Al    Si     P     S    Cl    Ar     K    Ca
    0.741 0.000 1.595 1.343 1.320 1.140 1.090 1.000 1.014 0.000 1.887 1.730 1.648 1.520 1.435 1.374 1.315 1.292 2.243 2.003 % H
    0.000 1.081 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 % He
    0.000 0.000 2.673 0.000 0.000 0.000 0.000 1.688 1.564 0.000 2.889 0.000 0.000 0.000 0.000 0.000 2.180 0.000 3.270 0.000 % Li
    0.000 0.000 0.000 2.460 0.000 0.000 0.000 1.331 1.400 0.000 0.000 0.000 0.000 0.000 0.000 1.742 1.797 0.000 0.000 0.000 % Be
    0.000 0.000 0.000 0.000 1.763 1.491 1.645 1.265 1.317 0.000 0.000 0.000 0.000 0.000 0.000 1.609 1.750 0.000 0.000 0.000 % B
    0.000 0.000 0.000 0.000 0.000 1.580 1.492 1.448 1.398 0.000 0.000 0.000 0.000 1.875 1.858 1.849 1.813 0.000 0.000 0.000 % C
    0.000 0.000 0.000 0.000 0.000 0.000 1.864 1.507 1.512 0.000 0.000 0.000 1.786 1.575 1.491 1.497 1.975 0.000 0.000 0.000 % N
    0.000 0.000 0.000 0.000 0.000 0.000 0.000 1.516 1.421 0.000 1.950 1.767 1.618 1.510 1.512 1.574 1.696 0.000 0.000 1.976 % O
    0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 1.412 0.000 1.926 1.770 1.654 1.604 1.593 1.646 1.697 0.000 2.171 1.967 % F
    0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 3.100 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 % Ne
    0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 3.079 0.000 0.000 0.000 0.000 0.000 2.584 0.000 3.589 0.000 % Na
    0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 3.891 0.000 0.000 0.000 2.143 2.199 0.000 0.000 0.000 % Mg
    0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 2.701 0.000 0.000 2.029 2.240 0.000 0.000 0.000 % Al
    0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 2.320 0.000 1.929 2.076 0.000 0.000 0.000 % Si
    0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 2.219 1.900 2.214 0.000 0.000 0.000 % P
    0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 2.059 2.076 0.000 0.000 0.000 % S
    0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 1.988 0.000 2.667 2.437 % Cl
    0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 % Ar
    0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 3.905 0.000 % K
    0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 % Ca
    ];

yTrain = zeros(0,1);
xTrain = zeros(0,2);
for i = 1:20
    for j = i:20
        if(distReal(i,j))
            yTrain(end+1,1) = distReal(i,j);
            xTrain(end+1,:) = [i j];
        end
    end
end

for i = 1:size(xTrain,1)
    x1 = xTrain(i,1);
    x2 = xTrain(i,2);
    
    new_xTrain(i, :) = Feature(x1, x2);
end

A = (new_xTrain'*new_xTrain) \ new_xTrain'*yTrain;

sum(((new_xTrain * A - yTrain)).^2)
sum(((new_xTrain * A - yTrain)./yTrain).^2)


for x1 = 1:20
    for x2 = 1:20
        feat = Feature(x1, x2);
        distSim(x1, x2) = feat * A;
    end
end

distReal(distReal==0) = NaN;
errMat = triu(distSim) - distReal
err = reshape(errMat, [], 1);

