function err = error1(vec)

k1 = vec(1);
k0 = vec(2);
a21 = vec(3);
a20 = vec(4);
a11 = vec(5);
a10 = vec(6);
a01 = vec(7);
a00 = vec(8);

distSim = zeros(20);

for i = 1:20
    for j = 1:20
        distSim(i,j) = generative(i,j, k1,k0, a21,a20,a11,a10,a01,a00);
    end
end
distSim = distSim + distSim';
% distSim = triu(distSim);
% distSim = distSim + distSim' - diag(diag(distSim));

distReal = ...
    [...H    He    Li    Be     B     C     N     O     F    Ne    Na    Mg    Al    Si     P     S    Cl    Ar     K    Ca
    0.741 0.000 1.595 1.343 1.320 1.140 1.090 1.000 1.014 0.000 1.887 1.730 1.648 1.520 1.435 1.374 1.315 1.292 2.243 2.003 % H
    0.000 1.081 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 % He
    0.000 0.000 2.673 0.000 0.000 0.000 0.000 1.688 1.564 0.000 2.889 0.000 0.000 0.000 0.000 0.000 2.180 0.000 3.270 0.000 % Li
    0.000 0.000 0.000 2.460 0.000 0.000 0.000 1.331 1.400 0.000 0.000 0.000 0.000 0.000 0.000 1.742 1.797 0.000 0.000 0.000 % Be
    0.000 0.000 0.000 0.000 1.763 1.491 1.645 1.265 1.317 0.000 0.000 0.000 0.000 0.000 0.000 1.609 1.750 0.000 0.000 0.000 % B
    0.000 0.000 0.000 0.000 0.000 1.580 1.492 1.448 1.398 0.000 0.000 0.000 0.000 1.875 1.858 1.849 1.813 0.000 0.000 0.000 % C
    0.000 0.000 0.000 0.000 0.000 0.000 1.864 1.507 1.512 0.000 0.000 0.000 1.786 1.575 1.491 1.497 1.975 0.000 0.000 0.000 % N
    0.000 0.000 0.000 0.000 0.000 0.000 0.000 1.516 1.421 0.000 1.950 1.767 1.618 1.510 1.512 1.574 1.696 0.000 0.000 1.976 % O
    0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 1.412 0.000 1.926 1.770 1.654 1.604 1.593 1.646 1.697 0.000 2.171 1.967 % F
    0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 3.100 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 % Ne
    0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 3.079 0.000 0.000 0.000 0.000 0.000 2.584 0.000 3.589 0.000 % Na
    0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 3.891 0.000 0.000 0.000 2.143 2.199 0.000 0.000 0.000 % Mg
    0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 2.701 0.000 0.000 2.029 2.240 0.000 0.000 0.000 % Al
    0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 2.320 0.000 1.929 2.076 0.000 0.000 0.000 % Si
    0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 2.219 1.900 2.214 0.000 0.000 0.000 % P
    0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 2.059 2.076 0.000 0.000 0.000 % S
    0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 1.988 0.000 2.667 2.437 % Cl
    0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 % Ar
    0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 3.905 0.000 % K
    0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 % Ca
    ];

distReal = distReal + distReal' - diag(diag(distReal));

distReal(distReal==0) = NaN;

err = reshape(distSim - distReal, [], 1);

err = err(~isnan(err));

end


function dist = generative(i,j, k1,k0, a21,a20,a11,a10,a01,a00)
if(j<=2)
    dist = (k1*i + k0);
elseif(j<=10)
    dist = (k1*i + k0) + a21*j^2+a11*j+a01;
elseif(j<=18)
    dist = 2*(k1*i + k0) + a20*(j-8)^2+a10*(j-8)+a00;
elseif(j<=20)
    dist = 3*(k1*i + k0);
else
    disp('wrong');
end

end